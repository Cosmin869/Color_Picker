//pinii pentru fiecare culoare
int red = 9;
int green = 10;
int blue = 11;

void setup() {
  pinMode(red, OUTPUT);
  pinMode(green, OUTPUT);
  pinMode(blue, OUTPUT);
  Serial.begin(9600);  // trebuie sa fie aceiasi cu cea de pe python
  attachInterrupt(digitalPinToInterrupt(0), serialEvent, FALLING);

}

void loop() {

}

void serialEvent(){
  if (Serial.available()) {
    //delay(10);
    String colorData = Serial.readStringUntil('\n');
    colorData.trim();
    
    // Impartim codul numeric al culorilor
    int commaIndex = colorData.indexOf(',');
    String redValue = colorData.substring(0, commaIndex);
    colorData.remove(0, commaIndex + 1);
    commaIndex = colorData.indexOf(',');
    String greenValue = colorData.substring(0, commaIndex);
    String blueValue = colorData.substring(commaIndex + 1);
    
    // convertim din string in int
    int red1 = redValue.toInt();
    int green1 = greenValue.toInt();
    int blue1 = blueValue.toInt();
    
    // trimitem pinilor culoarea obtinuta
    analogWrite(red, red1);
    analogWrite(green, green1);
    analogWrite(blue, blue1);
    //delay(1000);

    Serial.flush();
  }
}
